---
title: "Aterrizajes Meteor√≠ticos"
description: |
  Usando datos extra√≠dos de los registros de la NASA: [Datos](https://catalog.data.gov/dataset/meteorite-landings)
author: 
    - name: Cristina Tormos (tordela@alumni.uv.es)
date: 01-19-2024
categories: [trabajo Big Data]
image: imagenes/nasa1.jpeg
about: 
  template: marquee
  image-width: 16em 
  image-shape: rounded
  links: 
    - icon: github
      text: Github
      href: https://github.com/ctorm27
output:
  html_document:
    toc: true
    toc_float: true
    fig_caption: true
    code_folding: hide
    code-tols: true
    code-link: true
    css: my_styles.css
---

## Introducci√≥n ‚òÑÔ∏è

Lo primero a considerar en este trabajo es: ¬øQu√© es un meteorito? Pues bien, un meteorito es un meteoroide que alcanza la superficie de un planeta debido a que no se desintegra por completo en la atm√≥sfera. La luminosidad dejada al desintegrarse se denomina meteoro.

![ Diferentes tipos de meteoritos (SPMNTwitter)](https://s3.ppllstatics.com/canarias7/www/multimedia/202212/01/media/cortadas/meteoro-kmiF-U180902589505JOI-1248x770@Canarias7.jpg)

Por tanto, los aterrizajes meteor√≠ticos son fen√≥menos fascinantes que han dejado su huella en la historia y han desencadenado preguntas fundamentales sobre el origen del sistema solar y la composici√≥n del cosmos.

En este trabajo, nos sumergiremos en datos sobre meteoritos que revelan mucho m√°s que simples estad√≠sticas.Vamos a explorar informaci√≥n clave como nombres, tipos, masas, fechas y ubicaciones geogr√°ficas de los meteoritos, utilizando m√©todos eficientes de procesamiento de datos. 

Los datos y paquetes necesarios se pueden cargar en la memoria de R/RStudio con este c√≥digo:

```{r}
#| code-fold: true

#Instalar packages necesarios
#pkgs_a_instalar <- c("tidyverse", "terra", "ggplot2", "plotly", "ggmap", "maps", "mapdata", "Hmisc", "sf", "lubridate", "readr", "data.table", "leaflet", "raster", "rgeos", "dplyr", "kableExtra", "gt", "gtExtras", "gridExtra", "gganimate", "DT", "ggthemes", "viridis","rnaturalearth")

#Cargar librer√≠as necesarias
library(tidyverse) 
library(terra) 
library(ggplot2)
library(plotly)
library(ggmap)
library(maps)
library(mapdata)
library(Hmisc)
library(sf)
library(lubridate)
library(readr)
library(data.table)
library(leaflet)
library(raster)
library(dplyr)
library(kableExtra)
library(gt)
library(gtExtras)
library(gridExtra)
library(gganimate)
library(DT)
library(ggthemes)
library(viridis)
library(rnaturalearth)

#Cargar los datos desde el archivo CSV
file_path <- "Meteorite_Landings.csv"
df <- read.csv(file_path, stringsAsFactors = FALSE)

```

## Trabajemos con los datos üìÇ

En esta secci√≥n, nos sumergiremos en la exploraci√≥n de los datos trabajando con la informaci√≥n recopilada en el DataFrame. 

### Tipos de meteoritos üîé

Podemos observar que tenemos dos tipos de meteoritos: 

1.**V√°lido** (*Valid*): que se refiere a un meteorito t√≠pico.

2.**Relicto** (*Relict*): indica un meteorito que ha sido altamente degradado por las condiciones clim√°ticas en la Tierra.

Ahora pues, contabilizaremos la cantidad de cada tipo y lo mostraremos en una tabla:

```{r}
#| code-fold: true

#Seleccionar variable 
tabla1 <- table(df$nametype)

#Adjudicar
Tipos <- data.frame(Tipo = names(tabla1), Cantidad = as.numeric(tabla1))

#Crear tabla
knitr::kable(Tipos) %>%
  kableExtra::kable_styling(full_width = F) %>%
  column_spec(1, bold = T, border_right = T) %>%
  row_spec(1:2, bold = T, color = "black",  background = "white")

```
Esto muestra una tabla que indica que hay 75 meteoritos de tipo "Relicto" y 45641 meteoritos de tipo "V√°lido".

### Tipos de observaciones üî≠

Podemos observar que tenemos dos tipos de observaciones(*fall*): 

1.**Ca√≠do** (*Fell*): indica que la ca√≠da del meteorito fue observada.

2.**Encontrado** (*Found*): se√±ala que la ca√≠da del meteorito no fue observada.

```{r}
#| code-fold: true

#Seleccionar variable
tabla2 <- table(df$fall)

#Adjudicar
Observaciones <- data.frame(Observaciones = names(tabla2), Cantidad = as.numeric(tabla2))

#Crear
knitr::kable(Observaciones) %>%
  kableExtra::kable_styling(full_width = F) %>%
  column_spec(1, bold = T, border_right = T) %>%
  row_spec(1:2, bold = T, color = "black",  background = "white")

```
Esta tabla nos dice que hay 1107 observaciones de meteoritos que fueron vistos al caer y 44609 observaciones de meteoritos que fueron encontrados sin haber sido observados al caer.

### Masa del meteorito ‚öñÔ∏è

Ahora queremos revisar la lista de meteoritos y saber cual es su masa en promedio.

```{r}
#| code-fold: true

#Seleccionar variable
tabla3 <- summary(df$mass)

#Adjudicar y crear cuartiles
Masa <- data.frame(
  Estad√≠stica = c("Min.", "Primer cuartil", "Mediana", "Media", "Tercer cuartil.", "Max.", "NA's"),
  Valor = as.numeric(tabla3)
)

#Crear tabla
knitr::kable(Masa) %>%
  kableExtra::kable_styling(full_width = F) %>%
  column_spec(1, bold = T, border_right = T) %>%
  row_spec(1:nrow(Masa), bold = T, color = "black", background = "white")

```


De este an√°lisis obtenemos la siguiente informaci√≥n (expresada en gramos): 

¬∑ El peso m√≠nimo es de 0.

¬∑ Un 25% de los meteoritos pesan 7 o menos.

¬∑ La mediana es 33, lo que nos sugiere que muchos meteoritos son relativamente ligeros.

¬∑El promedio es 13280, as√≠ que hay algunos meteoritos realmente grandes en los datos.

¬∑El 75% de los meteoritos pesan 203 o menos.

¬∑El m√°s pesado es masivo, con un peso de 60000000.

¬∑Adem√°s tenemos, 131 casos sin informaci√≥n sobre su masa.


### Clase y  grupo del meteorito üëΩ

La notaci√≥n de "*recclass*" suele seguir un sistema alfanum√©rico que indica la clase y el grupo del meteorito. Esta informaci√≥n proporciona detalles sobre la composici√≥n y caracter√≠sticas del meteorito bas√°ndose en su an√°lisis. Cada tipo de meteorito puede tener su propia clasificaci√≥n basada en la informaci√≥n recopilada durante la investigaci√≥n cient√≠fica. 

```{r}
#| code-fold: true

#Seleccionar variable
tabla4 <- table(df$recclass)

#Adjudicar
Recclass <- data.frame(Recclass = names(tabla4), Frecuencia = as.numeric(tabla4))

#Mejorar
filas_por_grupo <- 10

grupos_recclass <- split(Recclass, rep(1:(ceiling(nrow(Recclass) / filas_por_grupo)), each = filas_por_grupo, length.out = nrow(Recclass)))

#Creaar tabla
tabla_interactiva <- datatable(
  Recclass,
  options = list(
    paging = TRUE,
    pageLength = filas_por_grupo,
    lengthMenu = c(filas_por_grupo, 2 * filas_por_grupo, 3 * filas_por_grupo),
    info = FALSE
  ),
  colnames = c("Recclass", "Frecuencia"),
  caption = "Tabla de Clases de Recclass",
) %>%
  formatStyle(
    'Recclass',
    backgroundColor = 'white',
    color = 'black'
  ) %>%
  formatStyle(
    'Frecuencia',
    backgroundColor = 'white',
    color = 'black'
)

#Mostrar tabla
tabla_interactiva
```

De esta tabla podemos concluir que hay 466 tipos de *recclass*.

### A√±os en que sucedi√≥ el aterrizaje üåè

En esta secci√≥n vamos a ver en que a√±os cayeron los meteoritos.


```{r}
#| code-fold: true

#Seleccionar variable
tabla5 <- table(df$year)

#Adjudicar
Year <- data.frame(Year = names(tabla5), Cantidad = as.numeric(tabla5))

#Mejorar
filas_por_grupo_year <- 10

grupos_year <- split(Year, rep(1:(ceiling(nrow(Year) / filas_por_grupo_year)), each = filas_por_grupo_year, length.out = nrow(Year)))

# Crear tabla
tabla_interactiva_year <- datatable(
  Year,
  options = list(
    paging = TRUE,
    pageLength = filas_por_grupo_year,
    lengthMenu = c(filas_por_grupo_year, 2 * filas_por_grupo_year, 3 * filas_por_grupo_year),
    info = FALSE
  ),
  colnames = c("A√±o", "Cantidad"),
  caption = "Tabla de A√±os"
) %>%
  formatStyle(
    'Year',  # Corregir aqu√≠ el nombre de la columna
    backgroundColor = 'white',
    color = 'black'
  ) %>%
  formatStyle(
    'Cantidad',
    backgroundColor = 'white',
    color = 'black'
  )

#Mostrar tabla
tabla_interactiva_year

```

De esta tabla podemos concluir que muchos a√±os han aterrizado meteoritos en la tierra, normalmente 1 o 2 por a√±o. Sin embargo, si filtramos la lista para mostrar los 5 a√±os con m√°s aterrizajes de meteoritos:

```{r}
#| code-fold: true

#Adjudicar
cuenta <- df %>%
  group_by(year) %>%
  summarise(Cantidad = n())

#Filtrar
top5 <- cuenta %>%
  arrange(desc(Cantidad)) %>%
  slice(1:5)

#Crear tabla
knitr::kable(top5) %>%
  kableExtra::kable_styling(full_width = F) %>%
  column_spec(2, bold = T, border_right = T) %>%
  row_spec(1:5, bold = T, color = "black", background = "white")

```
Con esta tabla, observamos que los a√±os m√°s destacables ser√≠an: 2003, 1979, 1998,2006 y 1988.

## An√°lisis gr√°fico üìà

Ahora que ya tenemos la extracci√≥n de informaci√≥n de los datos, podemos hacer diversos an√°lisis gr√°ficos.

### Top 5 üèÜ

Puesto que acabamos de encontrar los 5 a√±os con m√°s aterrizajes meteorit√≠cos, podemos verlo m√°s claramente con un gr√°fico de barras:

```{r}
#| code-fold: true

#Crear gr√°fico
ggplot(top5, aes(x = Cantidad, y = as.factor(year))) +
  geom_bar(stat = "identity", fill = c("blue1", "brown1", "olivedrab1", "magenta1", "yellow")) +
  geom_text(aes(label = Cantidad), hjust = -0.1, vjust = 0.5, color = "black", size = 3, fontface = "bold") +
  labs(title = "Top 5 a√±os con m√°s meteoritos",
       x = "Cantidad de meteoritos",
       y = "A√±o") +
  theme_minimal()

```

### Densidad de Masa de Meteoritos üï≥Ô∏è

En este an√°lisis nos enfocamos en la densidad de masa de meteoritos, utilizando informaci√≥n sobre la masa, el tipo de meteorito (nametype), y si el meteorito tuvo una ca√≠da visible o no(fall). El objetivo es comprender la distribuci√≥n de la masa y c√≥mo var√≠a seg√∫n el tipo de meteorito y la ocurrencia de una ca√≠da.

El an√°lisis de la densidad de masa de los meteoritos es crucial para desentra√±ar la historia y composici√≥n de nuestro sistema solar. Proporciona valiosa informaci√≥n sobre los procesos de formaci√≥n de estos cuerpos celestes, contribuyendo a nuestra comprensi√≥n de la diversidad y evoluci√≥n de los objetos presentes en el espacio. Este estudio es esencial para revelar los misterios detr√°s de la g√©nesis y desarrollo de planetas, asteroides y otros cuerpos celestes.

::: {.panel-tabset}

#### Seg√∫n el Tipo de Meteorito

```{r}
#| code-fold: true

#Seleccionar
df$masa <- df$mass..g. + 1e-6 

#Definir
df$log_masa <- log10(df$masa)

#Filtrar
df_filtered <- df[is.finite(df$log_masa), ]

#Crear gr√°fico
ggplot(df_filtered, aes(x = log_masa, fill = nametype)) +
  geom_density(alpha = 0.5) +
  labs(x = "Logaritmo en base 10 de Masa", y = "Densidad", title = "Densidad de Masa seg√∫n Tipo de Meteorito") +
  theme_minimal()

```

#### Seg√∫n el tipo de Ca√≠da.

```{r}
#| code-fold: true

#Crear gr√°fico
ggplot(df_filtered, aes(x = log_masa, fill = fall)) +
  geom_density(alpha = 0.5) +
  labs(x = "Logaritmo en base 10 de Masa", y = "Densidad", title = "Densidad de Masa seg√∫n Variable 'fall'") +
  theme_minimal()

```
:::

A trav√©s de estos gr√°ficos de densidad, hemos obtenido insights visuales sobre la distribuci√≥n de masa de los meteoritos en relaci√≥n con el tipo y la ocurrencia de ca√≠das. 

### Visualizaci√≥n de Meteoritos a lo Largo de los Siglos üëÄ

Estos gr√°ficos y animaciones visualizan la cantidad de meteoritos registrados a lo largo del tiempo, clasificados por siglo. Proporcionan una perspectiva hist√≥rica y comparativa de los eventos meteor√≠ticos desde el siglo XIX hasta principios del siglo XXI.

```{r}
#| code-fold: true

#Filtrar y adjudicar
dfyear <- df %>%
  mutate(siglo = case_when(
    year >= 1800 & year < 1900 ~ "XIX",
    year >= 1900 & year < 2000 ~ "XX",
    year >= 2000 ~ "XXI"
  )) %>%
  group_by(year, siglo) %>%
  summarise(Cantidad_Meteoritos = n(), .groups = 'drop', na.rm = TRUE)

```


::: {.panel-tabset}

#### Siglo XXI
```{r}
#| code-fold: true

#Crear gr√°fico
plot_XXI <- ggplot(dfyear[dfyear$siglo == "XXI", ], aes(x = year, y = Cantidad_Meteoritos)) +
  geom_line() +
  labs(title = "Siglo XXI", x = "A√±o", y = "Cantidad de Meteoritos")+
  theme_bw()

#Mostrar gr√°fico
plot_XXI
```

#### Siglo XX
```{r}
#| code-fold: true

#Crear gr√°fico
plot_XX <- ggplot(dfyear[dfyear$siglo == "XX", ], aes(x = year, y = Cantidad_Meteoritos)) +
  geom_line() +
  labs(title = "Siglo XX", x = "A√±o", y = "Cantidad de Meteoritos")+
  theme_bw()

#Mostrar gr√°fico
plot_XX
```

#### Siglo XIX
```{r}
#| code-fold: true

#Crear gr√°fico
plot_XIX <- ggplot(dfyear[dfyear$siglo == "XIX", ], aes(x = year, y = Cantidad_Meteoritos)) +
  geom_line() +
  labs(title = "Siglo XIX", x = "A√±o", y = "Cantidad de Meteoritos") +
  theme_bw()

#Mostrar gr√°fico
plot_XIX
```

:::

Con estos gr√°ficos podemos observar la tendencia y cambios a lo largo del tiempo.

Para observar la tendencia desde 1800 hasta 2030:

```{r}
#| code-fold: true

#Crear gr√°fico
ggplot(dfyear, aes(x = year, y = Cantidad_Meteoritos, color = siglo)) +
  geom_line() +
  labs(title = "Cantidad de Meteoritos por A√±o y Siglo", x = "A√±o", y = "Cantidad de Meteoritos") +
  scale_color_manual(values = c("XIX" = "blue", "XX" = "orange", "XXI" = "purple")) +
  xlim(1800, 2030) +
  theme_bw()

```
Este gr√°fico une cada siglo, permitiendo una comparaci√≥n directa de las cantidades de meteoritos entre los siglos. Cada siglo est√° representado por un color, resaltando las diferencias y similitudes en los patrones observados.

Podemos observar que en los √∫ltimos 50 a√±os, ha surgido una tendencia marcada en el aumento de aterrizajes de meteoritos, revelando un fen√≥meno fascinante. Este incremento puede atribuirse a avances tecnol√≥gicos significativos que han ampliado la capacidad de observaci√≥n y detecci√≥n de eventos espaciales, as√≠ como a una mayor conciencia p√∫blica que ha impulsado el reporte y registro de tales eventos. La eliminaci√≥n de barreras geogr√°ficas y la r√°pida difusi√≥n de informaci√≥n a trav√©s de medios digitales tambi√©n han contribuido a esta tendencia.

### Distribuci√≥n Interactiva de Meteoritos (2007): Cuartil de Masa por Observaci√≥n y Validez üåå

En el an√°lisis de meteoritos observados y validados durante el a√±o 2007, se explor√≥ la distribuci√≥n de masas en relaci√≥n con sus cuartiles correspondientes. Este conjunto de datos filtrado incluye √∫nicamente meteoritos clasificados como "Valid" y que fueron observados y encontrados. El objetivo es visualizar la distribuci√≥n de las masas de meteoritos en el tercer cuartil y proporcionar informaci√≥n detallada al interactuar con los puntos del gr√°fico.

Se ha seleccionado un a√±o concreto y se han filtrado los datos para reducir el n√∫mero excesivo de observaciones y as√≠ conseguir una mejor visualizaci√≥n, separando, adem√°s por Cuartiles.

::: {.panel-tabset}
#### Cuartil 1
```{r}
#| code-fold: true

#Filtrar
df_filtered1 <- df %>%
  filter(nametype == "Valid" & fall == "Found" & !is.na(mass..g.) & year == 2007) %>%
  mutate(cuartil_masa = cut(mass..g., breaks = quantile(mass..g., c(0, 0.25, 0.5, 0.75, 1), na.rm = TRUE), labels = FALSE)) %>% filter(cuartil_masa == 1)

#Crear gr√°fico
gg1 <- ggplot(df_filtered1, aes( x = mass..g., y = cuartil_masa, color = name)) +
  geom_point(alpha = 0.7, size = 2) +
  labs(title = "Distribuci√≥n de Masas del Cuartil 1",
       x = "Masa del Meteorito", y = "Cuartiles de Masa") +
  scale_color_viridis(discrete = TRUE) +
  theme_minimal()+
  theme(legend.position = "none")+
  theme(axis.text = element_text(size = 5))

#Mostrar gr√°fico
ggplotly(gg1, tooltip = "all", height = 400)
```
#### Cuartil 2
```{r}
#| code-fold: true

#Filtrar
df_filtered2 <- df %>%
  filter(nametype == "Valid" & fall == "Found" & !is.na(mass..g.) & year == 2007) %>%
  mutate(cuartil_masa = cut(mass..g., breaks = quantile(mass..g., c(0, 0.25, 0.5, 0.75, 1), na.rm = TRUE), labels = FALSE)) %>% filter(cuartil_masa == 2)

#Crear gr√°fico
gg2 <- ggplot(df_filtered2, aes( x = mass..g., y = cuartil_masa, color = name)) +
  geom_point(alpha = 0.7, size = 2) +
  labs(title = "Distribuci√≥n de Masas del Cuartil 2",
       x = "Masa del Meteorito", y = "Cuartiles de Masa") +
  scale_color_viridis(discrete = TRUE) +
  theme_minimal()+
  theme(legend.position = "none")+
  theme(axis.text = element_text(size = 5))

#Mostrar gr√°fico
ggplotly(gg2, tooltip = "all", height = 400)
```

#### Cuartil 3
```{r}
#| code-fold: true

#Filtrar
df_filtered3 <- df %>%
  filter(nametype == "Valid" & fall == "Found" & !is.na(mass..g.) & year == 2007) %>%
  mutate(cuartil_masa = cut(mass..g., breaks = quantile(mass..g., c(0, 0.25, 0.5, 0.75, 1), na.rm = TRUE), labels = FALSE)) %>% filter(cuartil_masa == 3)

#Crear gr√°fico
gg3 <- ggplot(df_filtered3, aes( x = mass..g., y = cuartil_masa, color = name)) +
  geom_point(alpha = 0.7, size = 2) +
  labs(title = "Distribuci√≥n de Masas del Cuartil 3",
       x = "Masa del Meteorito", y = "Cuartiles de Masa") +
  scale_color_viridis(discrete = TRUE) +
  theme_minimal()+
  theme(legend.position = "none")+
  theme(axis.text = element_text(size = 6))

#Mostrar gr√°fico
ggplotly(gg3, tooltip = "all", height = 400)
```

#### Cuartil 4
```{r}
#| code-fold: true

#Filtrar
df_filtered4 <- df %>%
  filter(nametype == "Valid" & fall == "Found" & !is.na(mass..g.) & year == 2007) %>%
  mutate(cuartil_masa = cut(mass..g., breaks = quantile(mass..g., c(0, 0.25, 0.5, 0.75, 1), na.rm = TRUE), labels = FALSE)) %>% filter(cuartil_masa == 4)

#Crear gr√°fico
gg4 <- ggplot(df_filtered4, aes( x = mass..g., y = cuartil_masa, color = name)) +
  geom_point(alpha = 0.7, size = 2) +
  labs(title = "Distribuci√≥n de Masas del Cuartil 4",
       x = "Masa del Meteorito", y = "Cuartiles de Masa") +
  scale_color_viridis(discrete = TRUE) +
  theme_minimal()+
  theme(legend.position = "none")+
  theme(axis.text = element_text(size = 5))

#Mostrar gr√°fico
ggplotly(gg4, tooltip = "all", height = 400)
```
:::

#### Para una visualizaci√≥n conjunta: 

```{r}
#| code-fold: true

#Crear gr√°fico conjunto
gg <- grid.arrange(gg1, gg2, gg3, gg4, ncol = 2)
```

## Mapas üó∫Ô∏è

Ahora con estos mapas intentaremos trazar la geograf√≠a de estos eventos celestes, mostrando d√≥nde exactamente se han encontrado estos meteoritos.

### Distribuci√≥n Meteoritos Aterrizados üåè

En esta secci√≥n, exploraremos la distribuci√≥n geogr√°fica de los meteoritos aterrizados. El mapa proporcionar√° una visualizaci√≥n general de las ubicaciones donde se han encontrado estos eventos celestes a lo largo del tiempo.

```{r}
#| code-fold: true

#Cargar
world <- map_data('world')

#Crear mapa
mundo <- map_data('world')
head(mundo)
ggplot() +
  geom_polygon(data=world, aes(x=long, y=lat, group=group)) +
  geom_point(data=df, aes(x=reclong, y=reclat), color ='purple', alpha=0.2)
```

### Distribuci√≥n Meteoritos Aterrizados seg√∫n Tipo y Masa üåç

En esta secci√≥n, exploraremos la distribuci√≥n geogr√°fica de los meteoritos aterrizados, teniendo en cuenta tanto el tipo como la masa de estos eventos celestes.

```{r}
#| code-fold: true

#Crear mapa
ggplot() +
  geom_polygon(data = world, aes(x = long, y = lat, group = group)) +
  geom_point(data = df, aes(x = reclong, y = reclat, color = fall, size = log_masa), alpha = 0.15) +
  scale_color_manual(values = c("Fell" = "#9AFF9A", "Found" = "#FF1493")) +
  theme(legend.position = c(0.9, 0.5)) +
  labs(size = 'masa(log10)')
```


### Distribuci√≥n Meteoritos Aterrizados seg√∫n Siglo y Tipo üåé

Aqu√≠ nos enfocaremos en la distribuci√≥n geogr√°fica de los meteoritos aterrizados, pero esta vez analizaremos c√≥mo se relaciona con el siglo en que ocurrieron y su tipo.

::: {.panel-tabset}

#### Siglo XIX
```{r}
#| code-fold: true

#Crear mapa
ggplot() +
  geom_polygon(data = world, aes(x = long, y = lat, group = group)) +
  geom_point(data = df[substring(df$year, 1, 2) == "18", ], aes(x = reclong, y = reclat, color = factor(fall), size = log_masa), alpha = 0.2) +
  scale_color_manual(values = c("Fell" = "#9AFF9A", "Found" = "#FF1493")) +
  theme(legend.position = c(0.9, 0.5)) +
  labs(size = 'masa(log10)')

```

#### Siglo XX
```{r}
#| code-fold: true

#Crear mapa
ggplot() +
  geom_polygon(data = world, aes(x = long, y = lat, group = group)) +
  geom_point(data = df[substring(df$year, 1, 2) == "19", ], aes(x = reclong, y = reclat, color = factor(fall), size = log_masa), alpha = 0.2) +
  scale_color_manual(values = c("Fell" = "#9AFF9A", "Found" = "#FF1493")) +
  theme(legend.position = c(0.9, 0.5)) +
  labs(size = 'masa(log10)')

```


#### Siglo XXI
```{r}
#| code-fold: true

#Crear mapa
ggplot() +
  geom_polygon(data = world, aes(x = long, y = lat, group = group)) +
  geom_point(data = df[substring(df$year, 1, 2) == "20", ], aes(x = reclong, y = reclat, color = factor(fall), size = log_masa), alpha = 0.2) +
  scale_color_manual(values = c("Fell" = "#9AFF9A", "Found" = "#FF1493")) +
  theme(legend.position = c(0.9, 0.5)) +
  labs(size = 'masa(log10)')

```
:::

A trav√©s de estos mapas por siglos, podemos observar patrones interesantes en la distribuci√≥n geogr√°fica de meteoritos. En el siglo XIX, la mayor√≠a de los meteoritos observados fueron registrados en Europa, mientras que los encontrados fueron principalmente en Am√©rica. En el siglo XX, observamos un cambio con la mayor√≠a de los meteoritos observados en Europa, √Åfrica y Asia, pero la mayor√≠a de los meteoritos encontrados a√∫n se registraron en Am√©rica. En este √∫ltimo siglo, la distribuci√≥n se ha vuelto m√°s equitativa, extendi√©ndose alrededor del mundo, lo que sugiere una participaci√≥n m√°s global en la observaci√≥n y recuperaci√≥n de meteoritos.

### Meteoritos Aterrizados en 2003 (Mapas Markers) üìç

En esta secci√≥n, nos centraremos en los meteoritos aterrizados en el a√±o 2003. Este a√±o ha sido seleccionado debido a que registra el mayor n√∫mero de aterrizajes. Nos enfocaremos espec√≠ficamente en aquellos meteoritos que han sido encontrados y de los cuales disponemos de su geolocalizaci√≥n para obtener una visualizaci√≥n detallada de estos eventos celestes.

```{r}
#| code-fold: true

#Filtrar
dfmapas <- df %>%
  filter(fall == "Found" & year == 2003 & !is.na(reclat) & !is.na(reclong))
```

::: {.panel-tabset}

#### Mundo
```{r}
#| code-fold: true

#Crear mapa
mundo_1 <- dfmapas %>%
  leaflet() %>%
  addTiles() %>%
  addMarkers(
    lng = ~reclong,
    lat = ~reclat,
    popup = ~paste("Nombre: ", name, "<br>",
                   "Tipo: ", recclass, "<br>",
                   "Masa: ", mass..g., "g")
  )
mundo_1
```


#### Europa
```{r}
#| code-fold: true

#Crear mapa
europa <- dfmapas %>%
  filter(reclat >= 35 & reclat <= 70 & reclong >= -25 & reclong <= 45)

europa_1 <- europa %>%
  leaflet() %>%
  addTiles() %>%
  addMarkers(
    lng = ~reclong,
    lat = ~reclat,
    popup = ~paste("Nombre: ", name, "<br>",
                   "Tipo: ", recclass, "<br>",
                   "Masa: ", mass..g., "g")
  )%>%
  setView(lng = 10, lat = 50, zoom = 3) 

europa_1
```
#### Espa√±a
```{r}
#| code-fold: true

#Crear mapa
spain <- dfmapas %>%
  filter(reclat >= 35 & reclat <= 43 & reclong >= -9 & reclong <= 4)

spain_1 <- spain %>%
  leaflet() %>%
  addTiles() %>%
  addMarkers(
    lng = ~reclong,
    lat = ~reclat,
    popup = ~paste("Nombre: ", name, "<br>",
                   "Tipo: ", recclass, "<br>",
                   "Masa: ", mass..g., "g")
  )%>%
  setView(lng = -4, lat = 40, zoom = 5) 

spain_1
```
:::

Como podemos observar en estos tres mapas, el a√±o 2003 registr√≥ numerosos aterrizajes meteor√≠ticos en todo el mundo. Sin embargo, resulta notable que, en Europa, solo se identificaron tres de estos eventos y ninguno de ellos tuvo lugar en Espa√±a. Esta observaci√≥n resalta la variabilidad geogr√°fica de estos fen√≥menos celestes durante este a√±o espec√≠fico.

## Conclusi√≥n üöÄ

A trav√©s de los an√°lisis realizados en los datos de meteoritos, se ha observado una variabilidad significativa en la distribuci√≥n geogr√°fica de estos eventos celestes a lo largo del tiempo. En el siglo XIX, Europa fue testigo de la mayor√≠a de los meteoritos observados, mientras que la mayor√≠a de los encontrados se registraron en Am√©rica. A medida que avanzamos en el siglo XX, la observaci√≥n de meteoritos se expandi√≥ a Europa, √Åfrica y Asia, aunque la mayor√≠a de los meteoritos encontrados continuaron siendo reportados en Am√©rica. En el siglo XXI, la distribuci√≥n se ha vuelto m√°s equitativa en todo el mundo.

El an√°lisis espec√≠fico del a√±o 2003 revel√≥ un alto n√∫mero de aterrizajes meteor√≠ticos a nivel global, pero en Europa,la presencia fue limitada, destacando la variabilidad geogr√°fica de estos eventos incluso en a√±os de alta actividad.

En general, estos resultados resaltan la importancia de considerar la geograf√≠a y el tiempo al estudiar los fen√≥menos meteor√≠ticos, mostrando c√≥mo la observaci√≥n y recuperaci√≥n de meteoritos han evolucionado y se han distribuido de manera diversa a lo largo de los siglos.

![Generada con IA-1](./imagenes/IA1.png)

![Generada con IA-2](./imagenes/IA2.png)

## Bibliograf√≠a üìñ

Inspiraci√≥n para el trabajo:

- [Github](https://github.com/Guangtufan/Meteorite)

- [Github] (https://github.com/majvdvel/meteorites)


